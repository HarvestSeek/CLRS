<!-- Fix MathJax rendering on iOS Safari due to rendering long numbers as phone numbers. -->



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
	
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-5.1.0">
    
	<meta name="format-detection" content="telephone=no">

    
      
        <title>5.B-tree - Learning Notes of Algorithm</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.89dc9fe3.min.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ecd4686e.min.css">
      
      
        
        
        <meta name="theme-color" content="#4caf50">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/katex.css">
    
      <link rel="stylesheet" href="../../css/basic.css">
    
      <link rel="stylesheet" href="../../css/wab.css">
    
      <link rel="stylesheet" href="../../css/font.css">
    
      <link rel="stylesheet" href="../../css/simpletable.css">
    
      <link rel="stylesheet" href="../../css/ktblock.css">
    
      <link rel="stylesheet" href="../../css/pseudocode.css">
    
      <link rel="stylesheet" href="../../css/comptable.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">
    
    
      
        
<link rel="preconnect dns-prefetch" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-117404761-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview")})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    <body dir="ltr" data-md-color-primary="green" data-md-color-accent="blue">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1-b" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="Learning Notes of Algorithm" class="md-header-nav__button md-logo" aria-label="Learning Notes of Algorithm">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,15.4V6.1L13.71,10.13L18.09,10.5L14.77,13.39L15.76,17.67M22,9.24L14.81,8.63L12,2L9.19,8.63L2,9.24L7.45,13.97L5.82,21L12,17.27L18.18,21L16.54,13.97L22,9.24Z" /></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" /></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Learning Notes of Algorithm
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              5.B-tree
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
          

  

<nav class="md-tabs md-tabs--active" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../.." class="md-tabs__link md-tabs__link--active">
          Basis
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../color/" class="md-tabs__link">
          Problem Sets
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Learning Notes of Algorithm" class="md-nav__button md-logo" aria-label="Learning Notes of Algorithm">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,15.4V6.1L13.71,10.13L18.09,10.5L14.77,13.39L15.76,17.67M22,9.24L14.81,8.63L12,2L9.19,8.63L2,9.24L7.45,13.97L5.82,21L12,17.27L18.18,21L16.54,13.97L22,9.24Z" /></svg>

    </a>
    Learning Notes of Algorithm
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1" checked>
    
    <label class="md-nav__link" for="nav-1">
      Basis
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Basis" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Basis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." title="Preface" class="md-nav__link">
      Preface
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1-2" type="checkbox" id="nav-1-2">
    
    <label class="md-nav__link" for="nav-1-2">
      I Foundations
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="I Foundations" data-md-level="2">
      <label class="md-nav__title" for="nav-1-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        I Foundations
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../1-Fundamentals/1.1/" title="1.analysis" class="md-nav__link">
      1.analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../1-Fundamentals/1.2/" title="2.asymptotic complexity" class="md-nav__link">
      2.asymptotic complexity
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../1-Fundamentals/1.3/" title="3.solving recurrences" class="md-nav__link">
      3.solving recurrences
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1-3" type="checkbox" id="nav-1-3">
    
    <label class="md-nav__link" for="nav-1-3">
      II Sorting and Order Statistics
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="II Sorting and Order Statistics" data-md-level="2">
      <label class="md-nav__title" for="nav-1-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        II Sorting and Order Statistics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../2-sort/2.1/" title="1.Simple Sort" class="md-nav__link">
      1.Simple Sort
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2-sort/2.2/" title="2.Mergesort" class="md-nav__link">
      2.Mergesort
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2-sort/2.3/" title="3.Heap and Heapsort" class="md-nav__link">
      3.Heap and Heapsort
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2-sort/2.4/" title="4.Quicksort" class="md-nav__link">
      4.Quicksort
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2-sort/2.5/" title="5.Sorting in linear time" class="md-nav__link">
      5.Sorting in linear time
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2-sort/2.6/" title="6.Median and order statictics" class="md-nav__link">
      6.Median and order statictics
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1-4" type="checkbox" id="nav-1-4" checked>
    
    <label class="md-nav__link" for="nav-1-4">
      III Data Structures
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="III Data Structures" data-md-level="2">
      <label class="md-nav__title" for="nav-1-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        III Data Structures
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../3.1/" title="1.Elementary data structures" class="md-nav__link">
      1.Elementary data structures
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../3.2/" title="2.Hash tables" class="md-nav__link">
      2.Hash tables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../3.3/" title="3.Binary search trees" class="md-nav__link">
      3.Binary search trees
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../3.4/" title="4.Red-Black trees" class="md-nav__link">
      4.Red-Black trees
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        5.B-tree
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,9H17V7H3V9M3,13H17V11H3V13M3,17H17V15H3V17M19,17H21V15H19V17M19,7V9H21V7H19M19,13H21V11H19V13Z" /></svg>
        </span>
      </label>
    
    <a href="./" title="5.B-tree" class="md-nav__link md-nav__link--active">
      5.B-tree
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-b" class="md-nav__link">
    1. B 树及其性质
  </a>
  
    <nav class="md-nav" aria-label="1. B 树及其性质">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    (1). 辅存的结构
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-b" class="md-nav__link">
    (2). B 树的定义
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-b" class="md-nav__link">
    (3). B 树的高度
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-b_1" class="md-nav__link">
    2. B 树的操作
  </a>
  
    <nav class="md-nav" aria-label="2. B 树的操作">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    (1). 搜索
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    (2). 分裂结点
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    (3). 插入
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    (4). 借位与合并
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    (5). 删除
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-b_1" class="md-nav__link">
    3. B+ 树
  </a>
  
    <nav class="md-nav" aria-label="3. B+ 树">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-b_1" class="md-nav__link">
    (1). B+ 树的定义
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    (2). 插入、删除
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../3.6/" title="6.Interval trees" class="md-nav__link">
      6.Interval trees
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../3.7/" title="7.Segment trees" class="md-nav__link">
      7.Segment trees
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../3.8/" title="8.Disjoint-Set" class="md-nav__link">
      8.Disjoint-Set
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1-5" type="checkbox" id="nav-1-5">
    
    <label class="md-nav__link" for="nav-1-5">
      IV Advanced Design And Analysis &emsp;Techniques
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="IV Advanced Design And Analysis &emsp;Techniques" data-md-level="2">
      <label class="md-nav__title" for="nav-1-5">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        IV Advanced Design And Analysis &emsp;Techniques
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../4-Advanced/dp/" title="1.Dynamic Programming" class="md-nav__link">
      1.Dynamic Programming
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Problem Sets
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Problem Sets" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Problem Sets
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../color/" title="Color" class="md-nav__link">
      Color
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      Interval Tree
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Interval Tree" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Interval Tree
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../PART2/intervaltree/1/" title="rect area" class="md-nav__link">
      rect area
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">
    
    <label class="md-nav__link" for="nav-2-3">
      Union Find Set
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Union Find Set" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Union Find Set
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../PART2/ufset/eg/" title="some examples" class="md-nav__link">
      some examples
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../PART2/ufset/1/" title="longest consec seq" class="md-nav__link">
      longest consec seq
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../PART2/ufset/hitbricks/" title="hit bricks" class="md-nav__link">
      hit bricks
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4">
    
    <label class="md-nav__link" for="nav-2-4">
      DP
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="DP" data-md-level="2">
      <label class="md-nav__title" for="nav-2-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        DP
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../PART2/dp/editdistance/" title="edit distance" class="md-nav__link">
      edit distance
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../PART2/dp/maxsubarray/" title="maximum subarray" class="md-nav__link">
      maximum subarray
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../PART2/dp/rematch/" title="expression matching" class="md-nav__link">
      expression matching
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../PART2/dp/longestvalidparentheses/" title="longest valid parentheses" class="md-nav__link">
      longest valid parentheses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../PART2/dp/maxrect/" title="maximal rectangle" class="md-nav__link">
      maximal rectangle
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../PART2/dp/scramblestr/" title="scramble string" class="md-nav__link">
      scramble string
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-b" class="md-nav__link">
    1. B 树及其性质
  </a>
  
    <nav class="md-nav" aria-label="1. B 树及其性质">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    (1). 辅存的结构
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-b" class="md-nav__link">
    (2). B 树的定义
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-b" class="md-nav__link">
    (3). B 树的高度
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-b_1" class="md-nav__link">
    2. B 树的操作
  </a>
  
    <nav class="md-nav" aria-label="2. B 树的操作">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    (1). 搜索
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    (2). 分裂结点
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    (3). 插入
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    (4). 借位与合并
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    (5). 删除
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-b_1" class="md-nav__link">
    3. B+ 树
  </a>
  
    <nav class="md-nav" aria-label="3. B+ 树">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-b_1" class="md-nav__link">
    (1). B+ 树的定义
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    (2). 插入、删除
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                  <h1>5.B-tree</h1>
                
                <p><font class="generalcy"></p>
<h3 id="1-b">1. B 树及其性质</h3>
<p><cy>B</cy> 树也是对 <cy>BST</cy> 的一种推广。和红黑树不同的是，它是一种针对磁盘设计的数据结构，它的分支因子不小于 <cy>2</cy>，其值由磁盘单元的特性决定。</p>
<h4 id="1">(1). 辅存的结构</h4>
<p><img src="../imgl/disk.png" height=180 align=right></p>
<p>&emsp;计算机系统的主存通常由硅芯片构成，辅存基于磁盘。右图为一个典型的磁盘驱动器，它由一个或多个盘片构成 (<cy2>platter</cy2>)，盘片以固定的速度绕主轴 (<cy2>spindle</cy2>) 旋转。驱动器通过磁臂末尾的磁头读写盘片，磁头可以朝主轴移近或移远。由于需要旋转盘片和移动磁臂，磁盘的存取速度通常比硅芯片低 <cy>5</cy> 个数量级。<br>
&emsp;为平摊机械运动所花费的时间，磁盘一次会存取多个页面 (<cy2>page</cy2>)，一页的长度通常为 $2^{11}$~$2^{14}$ 个字节。一旦磁头正确定位，盘片也旋转到页面开头位置，剩下的读写过程就完全电子化了。<br>
&emsp;考虑需要在磁盘上持久化存储大量的 $(\mathit{key,\ value})$ 的场景，此时需要一个合适的数据结构保证效率。如果使用 <cy>Hash</cy> 表则会有以下问题：
<ul style="margin-top:-16px;margin-bottom:3px;line-height:29px;">
<li style="margin:1px 30px;">开销大、扩展性差：为了保持哈希表的效率需要更大的数组，接近填满后还需要转移数据至更大的哈希表</li>
<li style="margin:1px 30px;">不支持有序遍历、范围查询</li>
<li style="margin:1px 30px;">如果桶中的元素过多对磁盘 <cy>IO</cy> (机械运动的开销) 不友好</li>
</ul>
若使用红黑树，由于每读取一个结点就很可能导致磁盘的机械运动，尽管在 <cy>CPU</cy> 运行时间上有 $\log$ 效率，但在磁盘 <cy>IO</cy> 上开销很大。因此，我们需要牺牲一部分查找的效率，实现一种多路的平衡树</p>
<h4 id="2-b">(2). B 树的定义</h4>
<p>一棵 <cy>B</cy> 树是具有以下性质的有根树：
<ul style="margin-top:-16px;margin-bottom:10px">
<li style="margin:1px 26px;">每个结点 $x$ 具有以下属性 </li>
    <ul style="margin-top:0px;margin-bottom:0px;list-style-type:circle;line-height:30px;">
    <li style="margin:1px 46px;">$x.n$ : 存储在结点 $x$ 中的关键字个数</li>
    <li style="margin:1px 46px;">$\mathit{x.key_1,\ ...\ ,x.key_n}$ : 关键字本身，以非降序存放，即 $\mathit{x.key_1\leq\ ...\ \leq x.key_n}$。并且，内结点的关键字对应的数据也存储在内结点中</li>
    <li style="margin:1px 46px;">$\mathit{x.leaf}$ : 布尔值，表示 $x$ 是否为叶结点</li>
    </ul>
<li style="margin:1px 26px;">每个内部节点 $x$ 包含 $n+1$ 个指向子结点的指针，且 $\mathit{x.key_i}$ 对各子树的关键字范围加以分割，即 $k_1\leq\mathit{x.key_1}\leq k_2\leq \mathit{x.key_2}\ ...$</li>
<li style="margin:1px 26px;">每个叶结点具有相同深度，即树的高度 $h$</li>
<li style="margin:1px 26px;">每棵 <cy>B</cy> 树具有一个最小度数 $t$ <sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup></li>
    <ul style="margin-top:0px;margin-bottom:0px;list-style-type:circle;line-height:30px;">
    <li style="margin:1px 46px;">除了根结点外每个结点至少有 $t-1$ 个关键字，相应地，内部节点至少有 $t$ 个孩子</li>
    <li style="margin:1px 46px;">每个结点最多有 $2t-1$ 个关键字，相应地，内部节点至多有 $2t$ 个孩子</li>
    </ul>
</ul></p>
<h4 id="3-b">(3). B 树的高度</h4>
<p>以根结点为深度 <cy>0</cy>，一棵 <cy>B</cy> 树在深度 $h\ (h &gt; 0)$ 的一层至少有 $2t^{h-1}$ 个结点，因此对于关键字的个数 $n$，有<br>
<div class="ilmath">
$\displaystyle n\geq 1+(t-1)\sum_{i=1}^h2t^{i-1}=2t^h-1$
</div>
即可得到 $h\leq\log_t (n+1)/2$。与同为平衡树的红黑树相比，<cy>B</cy> 树的底数更大，因此高度更低，从而在各种树操作中减少了要检查的结点数，避免了大量的磁盘访问。</p>
<h3 id="2-b_1">2. B 树的操作</h3>
<p>在 <cy>B</cy> 树的操作中，始终保持如下约定：
<ul style="margin-top:-16px;margin-bottom:10px;line-height:30px;">
<li style="margin:1px 26px;">根结点始终固定在主存中，即无需对根做 <mag>DISK-READ</mag> 操作，但修改根结点需要一次 <mag>DISK-WRITE</mag></li>
<li style="margin:1px 26px;">任何被当做参数的结点在被传递之前，都要做一次 <mag>DISK-READ</mag></li>
</ul></p>
<h4 id="1_1">(1). 搜索</h4>
<pre class="pseudocode" style="width:320px;margin-top:0px;border:1px solid #000000;padding-top:0px;margin-left:30px;">
B-TREE-SEARCH(<i>x, k</i>)
<i>i</i> = 1
<b>while</b>  <i>i</i>  ≤  <i>x.n</i>  and  <i>k</i> > <i>x.key<sub>i</sub></i>
    <i>i</i> = <i>i</i> + 1
<b>if</b>  <i>i</i> ≤ <i>x.n</i>  and  </i>k</i> == <i>x.key<sub>i</sub></i>
    <b>return</b>  (<i>x, i</i>)
<b>else if</b>  <i>x.leaf</i>
    <b>return</b>  NIL
<b>else</b>  DISK-READ(<i>x, c<sub>i</sub></i>)
    <b>return</b>  B-TREE-SEARCH(<i>x, c<sub>i</sub>, k</i>)
</pre>

<p>访问磁盘页面数为 $O(h)=O(\log_t n)$，花费时间 $O(tn)$</p>
<h4 id="2">(2). 分裂结点</h4>
<p>过程 <mag>B-TREE-SPLIT-CHILD</mag> 的输入是一个非满的内结点 $x$ 和一个满子结点 $x.c_i$ 的下标 $i$。<br>
$x.c_i$ 根据中间关键字分裂成两个结点，其中间关键字上移到 $x$ 的相应位置。<br>
<ul style="margin-top:-15px;margin-bottom:10px;line-height:30px;">
<li style="margin:1px 26px;">根结点分裂是增加树高的唯一途径。</li>
</ul></p>
<p><img src="../imgl/bsplit.png" height=175></p>
<h4 id="3">(3). 插入</h4>
<p>沿着插入路径找到目标叶子结点后，通过分裂结点保证关键字的数量不会超过限制。具体可有以下两种实现方式：
<ul style="margin-top:-16px;margin-bottom:10px;line-height:30px;">
<li style="margin:1px 26px;">遇到满结点时再分裂：插入到目标位置后，如果发生分裂，其父结点会增加一个 $key$，因此递归向上判断</li>
<li style="margin:1px 26px;">沿途分裂满结点：为了避免向上回溯，需要保证找到目标结点时，它的父结点未满。因此，在沿插入路径向下的过程中，只要遇到一个满结点就分裂它，这样保证了每个当前结点的父结点都一定未满</li>
</ul></p>
<h4 id="4">(4). 借位与合并</h4>
<p>考虑从结点 $x$ 处删除了一个 $\it key$，导致 $x.n=t-2$，有两种方法维护 $x.n\geq t$ 
<ul style="margin-top:-16px;margin-bottom:10px;line-height:30px;">
<li style="margin:1px 26px;">借位：从左兄弟 $x_l$ 或右兄弟 $x_r$ 借来一个关键字，要求 $x_{\mathit{brother}}.n\geq t$</li>
    <ul style="margin-top:0px;margin-bottom:0px;list-style-type:circle;line-height:30px;">
    <li style="margin:1px 46px;">$x_l$ 最右关键字上移，$k_x$ 下移至 $x$ 最左处，同时 $x_l$ 的最右指针成为 $x$ 的最左指针</li>
    <li style="margin:1px 46px;">$x_r$ 最左关键字上移，$k_x$ 下移至 $x$ 最右处，同时 $x_l$ 的最左指针成为 $x$ 的最右指针</li></ul>
<li style="margin:1px 26px;">合并：把 $x_{bro}$、$x$ 以及 $k_x$ 合并，指针不会发生改变，要求 $x_{\mathit{brother}}.n\leq t$</li>
    <ul style="margin-top:0px;margin-bottom:0px;list-style-type:circle;line-height:30px;">
    <li style="margin:1px 46px;">$x_{\mathit{brother}}.n + t - 2 + 1\leq 2t-1$</li>
    <li style="margin:1px 46px;">合并会导致 $x._\mathit{parent}$ 减少一个 $\it key$</li>
    </ul>
</ul>
二者均可以用于修复删除导致的 <cy>B</cy> 树性质的破坏</p>
<h4 id="5">(5). 删除</h4>
<p>直到删除导致 $n&lt; t-1$ 再做处理，并不断向上回溯判断：
<ul style="margin-top:-15px;margin-bottom:10px">
<li style="margin:1px 26px;">如果待删关键字 $k$ 在非叶结点 $x$ 中，则向左/右找到 $k$ 的前驱/后继，用之代替 $k$，然后递归删除这个前驱/后继</li>
<li style="margin:1px 26px;">如果待删关键字 $k$ 在叶结点 $x$ 中，从 $x$ 中删除 $k$ <sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup></li>
    <ul style="margin-top:0px;margin-bottom:0px;list-style-type:circle;line-height:30px;">
    <li style="margin:1px 46px;">若删除后导致 $n&lt; t-1$，且某个相邻兄弟至少包含 $t$ 个关键字，借位</li>
    <li style="margin:1px 46px;">否则，合并，并递归向上判断</li></ul>
</ul></p>
<p>和插入操作类似，如果要避免回溯，就要在删除路径上沿途处理达到下界的结点
<ul style="margin-top:-15px;margin-bottom:10px">
<li style="margin:1px 26px;">沿路径下移前判断该子结点是否 $x.c_i.n=t-1$，若是则进行如下变换</li>
    <ul style="margin-top:0px;margin-bottom:0px;list-style-type:circle;line-height:30px;">
    <li style="margin:1px 46px;">若删除后导致 $n&lt; t-1$，且某个相邻兄弟至少包含 $t$ 个关键字，借位</li>
    <li style="margin:1px 46px;">否则，合并</li></ul>
<li style="margin:1px 26px;">如果待删关键字 $k$ 在非叶结点 $x$ 中，递归删除前驱/后继之后，还需要额外：</li>
<ul style="margin-top:0px;margin-bottom:0px;list-style-type:circle;line-height:30px;">
    <li style="margin:1px 46px;">如果 $k$ 的左右孩子都只有 $t-1$ 个关键字，则将这两个孩子与 $k$ 合并作为新的左孩子，然后在新的孩子中递归删除 $k$</li></ul>
<li style="margin:1px 26px;">如果待删关键字 $k$ 在叶结点 $x$ 中，直接从 $x$ 中删除 $k$</li>
</ul></p>
<h3 id="3-b_1">3. B<sup>+</sup> 树</h3>
<h4 id="1-b_1">(1). B<sup>+</sup> 树的定义</h4>
<p><cy>B</cy><sup>+</sup> 树是 <cy>B</cy> 树的变体：
<ul style="margin-top:-16px;margin-bottom:10px;line-height:30px;">
<li style="margin:1px 26px;">内结点只储存索引，叶结点存储索引和数据，且叶结点构成一张有序链表</li>
<li style="margin:1px 26px;">由于内结点只存储索引，其数量可以提升；若一个结点对应磁盘的一页，<cy>B</cy><sup>+</sup> 树的高度更小</li>
<li style="margin:1px 26px;"><cy>B</cy><sup>+</sup> 树每个索引的查询效率相同，而 <cy>B</cy> 树与之相比不够稳定</li>
</ul></p>
<h4 id="2_1">(2). 插入、删除</h4>
<p><cy>B</cy><sup>+</sup> 树的插入删除相比 <cy>B</cy> 树有以下不同：
<ul style="margin-top:-16px;margin-bottom:10px;line-height:30px;">
<li style="margin:1px 26px;">插入：叶结点分裂时，将上移的关键字保存在子结点中，其他结点分裂过程相同</li>
    <ul style="margin-top:0px;margin-bottom:0px;list-style-type:circle;line-height:30px;">
    <li style="margin:1px 46px;">通常上移的关键字对应的条目存放在右孩子中，实现左闭右开</li>
    </ul>
<li style="margin:1px 26px;">删除：叶结点借位时，直接借来兄弟的记录，并修改 $k_i$；叶结点合并时，直接删除父结点的 $k_i$，然后两个兄弟间合并</li>
</ul></p>
<p></font></p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>也可以通过阶数定义，阶数即结点的最大度，若设其为 $n$，则非叶结点的度的范围在闭区间 $\lceil n/2 \rceil$ 到 $n$ 内&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>这里是借位优先级更高，也可以合并优先级更高&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
</ol>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../3.4/" title="4.Red-Black trees" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                4.Red-Black trees
              </div>
            </div>
          </a>
        
        
          <a href="../3.6/" title="6.Interval trees" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                6.Interval trees
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z" /></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.36cbf620.min.js"></script>
      <script src="../../assets/javascripts/bundle.00c583dd.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: ["tabs"],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.7f7c8775.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../../js/katex.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>